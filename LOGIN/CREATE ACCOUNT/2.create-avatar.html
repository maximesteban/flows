<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Avatar - SocialApp</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bg-primary': '#FBF8F3',
                        'text-primary': '#000122',
                        'text-secondary': '#6C6051',
                        'btn-inactive': '#C6B7A4',
                        'btn-active': '#635FE5'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-bg-primary min-h-screen flex flex-col justify-center items-center p-4">
    <!-- Back Button -->
        <div class="fixed top-8 left-6 z-10">
            <button onclick="goBack()" class="w-12 h-12 bg-white hover:bg-gray-50 rounded-full flex items-center justify-center text-text-secondary hover:text-btn-active transition-all duration-200 shadow-lg hover:shadow-xl border border-gray-200">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
                </svg>
            </button>
        </div>
        
        <div class="p-8 w-full max-w-md relative overflow-hidden">
            
            
            <!-- Step Info -->
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-text-primary mb-2">Crea tu avatar</h2>
                <p class="text-text-secondary mb-3">Tu avatar es cómo te presentas en Placenet.<br>Ah! y puedes crear alguno más si lo deseas más adelante.</p>
                <span class="inline-block bg-gray-100 text-text-secondary px-3 py-1 rounded-full text-xs font-medium">
                    Paso 2 de 4
                </span>
            </div>
            
            <!-- Form -->
            <form id="avatarForm" class="space-y-6">
                <!-- Avatar Upload Section -->
                <div class="text-center">
                    <div class="mb-6">
                        <div 
                            id="avatarPreview" 
                            class="w-32 h-32 mx-auto border-3 border-dashed border-gray-300 rounded-full flex flex-col items-center justify-center cursor-pointer shadow-xl hover:border-btn-active hover:bg-blue-50 transition-all duration-200 bg-gray-50"
                            onclick="document.getElementById('avatarFile').click()"
                        >
                            <p class="text-sm text-text-secondary font-medium">Añadir foto</p>
                        </div>
                        <input type="file" id="avatarFile" accept="image/*" class="hidden">
                    </div>
                </div>
                
                <!-- Avatar Name -->
                <div class="space-y-2">
                    <label for="avatarName" class="block text-sm font-medium text-text-primary">Nombre del Avatar *</label>
                    <input 
                        type="text" 
                        id="avatarName" 
                        placeholder="Tu nickname" 
                        required
                        class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-btn-active focus:outline-none transition-colors"
                    >
                    <small class="text-xs text-text-secondary">Este será tu nombre público en la app</small>
                </div>
                
                <!-- Bio -->
                <div class="space-y-2">
                    <label for="avatarBio" class="block text-sm font-medium text-text-primary">Descripción</label>
                    <textarea 
                        id="avatarBio" 
                        placeholder="Cuéntanos algo sobre ti... (opcional)" 
                        rows="3" 
                        maxlength="150"
                        class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-btn-active focus:outline-none transition-colors resize-none"
                    ></textarea>
                    <div class="flex justify-end">
                        <span class="text-xs text-text-secondary">
                            <span id="charCount">0</span>/150
                        </span>
                    </div>
                </div>
                
                
                
                <!-- Form Actions -->
                <button 
                    type="submit" 
                    id="submitBtn"
                    disabled
                    class="w-full bg-btn-inactive text-white py-3 px-6 rounded-lg font-semibold transition-all duration-200 cursor-not-allowed"
                >
                    Continuar
                </button>
            </form>
        </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('avatarForm');
            const avatarFile = document.getElementById('avatarFile');
            const avatarPreview = document.getElementById('avatarPreview');
            const avatarName = document.getElementById('avatarName');
            const avatarBio = document.getElementById('avatarBio');
            const charCount = document.getElementById('charCount');
            const submitBtn = document.getElementById('submitBtn');
            
            let uploadedImage = null;

            // Initialize with user data
            initializeForm();

            function initializeForm() {
                const signupData = JSON.parse(sessionStorage.getItem('signupData') || '{}');
                
                if (signupData.firstName) {
                    avatarName.value = signupData.firstName;
                    validateForm(); // Check form validity after initialization
                }
            }

            // File upload handling
            avatarFile.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) { // 5MB limit
                        alert('La imagen debe ser menor a 5MB');
                        return;
                    }
                    
                    if (!file.type.startsWith('image/')) {
                        alert('Por favor, selecciona una imagen válida');
                        return;
                    }
                    
                    uploadedImage = file;
                    previewImage(file);
                }
            });

            function previewImage(file) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    avatarPreview.innerHTML = `
                        <img src="${e.target.result}" alt="Avatar preview" class="w-full h-full object-cover rounded-full">
                        <div class="absolute bottom-1 right-1 bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg">
                            <span class="text-sm">✏️</span>
                        </div>
                    `;
                    avatarPreview.className = avatarPreview.className.replace('border-dashed border-gray-300', 'border-solid border-green-500');
                    avatarPreview.classList.add('relative');
                };
                
                reader.readAsDataURL(file);
            }


            // Bio character counter
            avatarBio.addEventListener('input', function() {
                const length = this.value.length;
                charCount.textContent = length;
                
                if (length > 150) {
                    charCount.className = 'text-red-500';
                    this.value = this.value.substring(0, 150);
                } else if (length > 120) {
                    charCount.className = 'text-orange-500';
                } else {
                    charCount.className = 'text-text-secondary';
                }
            });



            // Form validation
            function validateForm() {
                const name = avatarName.value.trim();
                
                const isValid = name.length >= 2;
                
                if (isValid) {
                    submitBtn.disabled = false;
                    submitBtn.className = 'w-full bg-btn-active text-white py-3 px-6 rounded-lg font-semibold hover:bg-indigo-600 transition-all duration-200 transform hover:-translate-y-0.5 hover:shadow-lg cursor-pointer';
                } else {
                    submitBtn.disabled = true;
                    submitBtn.className = 'w-full bg-btn-inactive text-white py-3 px-6 rounded-lg font-semibold transition-all duration-200 cursor-not-allowed';
                }
            }

            avatarName.addEventListener('input', validateForm);

            // Form submission
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = avatarName.value.trim();
                
                if (name.length < 2) {
                    alert('Por favor, introduce un nombre para el avatar');
                    return;
                }
                
                // Collect avatar data
                const avatarData = {
                    name: name,
                    bio: avatarBio.value.trim(),
                    hasImage: uploadedImage !== null,
                    imageType: 'uploaded'
                };
                
                // Store data (integrate with your app's storage)
                sessionStorage.setItem('avatarData', JSON.stringify(avatarData));
                
                console.log('Navigate to interests with avatar data:', avatarData);
            });

            function goBack() {
                // Integration point for your app navigation
                console.log('Navigate back to signup');
            }

            // Initialize validation
            setTimeout(validateForm, 100);
        });
    </script>

    
</body>
</html>